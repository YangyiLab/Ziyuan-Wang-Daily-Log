- [2021-1-3](#2021-1-3)
  - [PLAN](#plan)
  - [UTHealth 面试准备](#uthealth-面试准备)
    - [讲稿修改](#讲稿修改)
    - [研究兴趣](#研究兴趣)
    - [潜在教授](#潜在教授)
- [2022-1-4](#2022-1-4)
  - [PLAN](#plan-1)
  - [方差分析](#方差分析)
  - [文献阅读](#文献阅读)
    - [结果](#结果)
- [2022-1-5](#2022-1-5)
  - [PLAN](#plan-2)
- [2022-1-6](#2022-1-6)
  - [PLAN](#plan-3)
  - [微生物主旨](#微生物主旨)
- [2022-1-7](#2022-1-7)
  - [PLAN](#plan-4)
  - [单细胞进度](#单细胞进度)
    - [Pre-Training](#pre-training)
  - [微生物](#微生物)
    - [Result](#result)
    - [Discussion](#discussion)
  - [统计学习](#统计学习)
    - [分布复习](#分布复习)
    - [检验](#检验)
- [2022-1-8](#2022-1-8)
  - [PLAN](#plan-5)
  - [单细胞](#单细胞)
    - [单细胞数据检查](#单细胞数据检查)
    - [模型进度](#模型进度)
  - [人类hsc](#人类hsc)
- [2022-1-9](#2022-1-9)
  - [PLAN](#plan-6)
  - [单细胞可视化](#单细胞可视化)
  - [微生物论文](#微生物论文)
    - [Graphical Abstract](#graphical-abstract)
  - [CellOracle](#celloracle)
    - [Summary](#summary)
    - [造血细胞研究](#造血细胞研究)
- [2022-1-10](#2022-1-10)
  - [PLAN](#plan-7)
  - [tmux滚轮](#tmux滚轮)
  - [LTR 学习内容](#ltr-学习内容)
- [2022-1-11](#2022-1-11)
  - [PLAN](#plan-8)
  - [转录因子重建问题](#转录因子重建问题)
- [2022-1-12](#2022-1-12)
  - [PLAN](#plan-9)
  - [LTR研究](#ltr研究)
    - [基因破坏和表观遗传控制](#基因破坏和表观遗传控制)
  - [LTR进化分析](#ltr进化分析)
  - [LTR 结构](#ltr-结构)
- [2022-1-13](#2022-1-13)
  - [PLAN](#plan-10)
  - [统计学学习](#统计学学习)
    - [单因素配对方差检验](#单因素配对方差检验)
    - [双因素方差检验](#双因素方差检验)
  - [微生物文章定稿](#微生物文章定稿)
  - [GBE文章](#gbe文章)
    - [重点](#重点)
    - [推荐阅读文章](#推荐阅读文章)
  - [进化树复习](#进化树复习)
    - [非概率论方法](#非概率论方法)
- [2022-1-14](#2022-1-14)
  - [PLAN](#plan-11)
- [2022-1-15](#2022-1-15)
  - [PLAN](#plan-12)
  - [单细胞结果overview](#单细胞结果overview)
  - [pre-training (Transforming Learning)](#pre-training-transforming-learning)
    - [tricks](#tricks)
    - [encoder](#encoder)
    - [decoder](#decoder)
  - [拟南芥项目规划](#拟南芥项目规划)
    - [Yijia Liu's TASK](#yijia-lius-task)
  - [cell oracle](#cell-oracle)
    - [数据集](#数据集)
    - [原理](#原理)
- [2022-1-16](#2022-1-16)
  - [PLAN](#plan-13)
  - [BLAST](#blast)
    - [步骤](#步骤)
    - [blast操作](#blast操作)
- [2022-1-17](#2022-1-17)
  - [PLAN](#plan-14)
  - [单细胞源代码学习](#单细胞源代码学习)
  - [ltr](#ltr)
    - [ML树](#ml树)
  - [多重检验](#多重检验)
    - [Bonferroni 法](#bonferroni-法)
    - [Scheff 法](#scheff-法)
    - [Tukey 法](#tukey-法)
- [2022-1-18](#2022-1-18)
  - [PLAN](#plan-15)
  - [序列下载](#序列下载)
- [2022-1-20](#2022-1-20)
  - [PLAN](#plan-16)
  - [单细胞预训练](#单细胞预训练)
  - [TE/G4构架设计](#teg4构架设计)
    - [VCF files](#vcf-files)
  - [下载格式](#下载格式)
- [2022-1-21](#2022-1-21)
  - [PLAN](#plan-17)
  - [统计学习](#统计学习-1)
    - [Tukey法 & TK法](#tukey法--tk法)
    - [与两两t分布区别](#与两两t分布区别)
  - [单细胞架构训练](#单细胞架构训练)
- [2022-1-22](#2022-1-22)
  - [PLAN](#plan-18)
  - [代码检查](#代码检查)
  - [BERT 微调](#bert-微调)
    - [Sentence Level](#sentence-level)
    - [word level](#word-level)
    - [QA](#qa)
  - [非参数检验](#非参数检验)
    - [皮尔逊卡方检验](#皮尔逊卡方检验)
- [2022-1-23](#2022-1-23)
  - [PLAN](#plan-19)
  - [统计学学习](#统计学学习-1)
    - [皮尔逊卡方](#皮尔逊卡方)
    - [2x2 联表](#2x2-联表)
- [2022-1-24](#2022-1-24)
  - [PLAN](#plan-20)
  - [vi学习](#vi学习)
  - [统计学学习](#统计学学习-2)
    - [U检验](#u检验)
- [2022-1-26](#2022-1-26)
  - [PLAN](#plan-21)
  - [单细胞可视化](#单细胞可视化-1)

# 2021-1-3

## PLAN
+ **毕业设计修改**
+ **分子生物学复习**
+ **面试准备**

## UTHealth 面试准备

### 讲稿修改

+ 修改下菠菜研究的细节

### 研究兴趣

+ 单细胞、脑胶质瘤的开发 、
+ 基因组学 变异等
+ microbiome
+ VAE

### 潜在教授

+ Akdes Serin-Harmanci
  + https://www.nature.com/articles/ncomms14433
  + 脑胶质瘤和单细胞的兴趣

+ Jacqueline Chyr
  +  1) 癌症基因组中的选择性剪接和多聚腺苷酸化，
  +  2) 影响增强子-启动子相互作用的 3D 基因组组织的大规模和小规模分析
  +  3) 系统生物学和肠道微生物组代谢-代谢物网络建模
  +  4) 开发用于生物医学数据分析的 AI 工具。

# 2022-1-4

## PLAN
+ **分子生物学复习**
+ **ppt修改**
+ **文献阅读**
+ **统计学学习**

## 方差分析

$$F = \frac{组间方差/自由度}{组内方差/自由度}$$

## 文献阅读

*高级别胶质瘤谱系多样性的单细胞转录组分析*

网站 https://genomemedicine.biomedcentral.com/articles/10.1186/s13073-018-0567-9

### 结果

Figure1 

![F1](https://media.springernature.com/full/springer-static/image/art%3A10.1186%2Fs13073-018-0567-9/MediaObjects/13073_2018_567_Fig1_HTML.png?as=webp)

通过聚类并进行分类

通过染色体异倍型进行PCA降维

通过染色体异倍型对于transformed程度进行打分

e展示异常倍性

**判断转化细胞从marker基因和染色体拷贝数判断**

Figure2

![F2](https://media.springernature.com/full/springer-static/image/art%3A10.1186%2Fs13073-018-0567-9/MediaObjects/13073_2018_567_Fig2_HTML.png?as=webp)

sox2 是Transformed cells的标志

# 2022-1-5

## PLAN
+ **分子生物学**
+ **面试**


# 2022-1-6

## PLAN
+ **微生物图片定稿**
+ **微生物结果改写**

## 微生物主旨

**氮肥和植物协同促进hitchhiking**

图一 没植物 画上氮肥微生物没有方向性
图二 加植物 画上氮肥微生物有方向性

# 2022-1-7

## PLAN
+ **单细胞进度**
+ **Result**
+ **模式图商议**
+ **整理工作思路**
+ **统计学学习**

## 单细胞进度

> 老鼠HSC数据集

最先计划 新数据集已有pipeline做训练(**在现有的network 正则化**)

### Pre-Training 

在现有的network 正则化 主要做 decoder 


## 微生物

### Result

完成了堆叠图、多样性以及功能、相关性图的描述。

**堆叠图**和**多样性**分析中修改较多

### Discussion

+ Bacillus 没菜没区别 加植物有区别 证明会影响Bacillus 影响细胞运动 影响hitchhiking
+ 通过加了植物后 不同氮肥下 Bacillus 不一样 中等浓度最高 **适量氮肥和植物促进Bacillus** 浓度过高 浓度过低的氮肥影响Bacillus运动
+ 结论 协同共同作用hitchhiking

另一段

+ 氮肥会促进植物生长 我们的结果表明了这个观点 植物生长图
+ 以往认为的原因 1 2 3 
+ 除了这些原因外 通过我们的实验，在加膜后，之间没有差异了（摆结果） 可能通过影响 hitchhiking 
+ 可以得出hitchhiking 促进植物生长

## 统计学习

### 分布复习


均值 正态 z分布 t分布

方差 卡方分布 自由度n-1

比例 t分布

相关系数 正态分布 t分布

### 检验


参数检验 样本量大 总体封据服从正态分布小样本服从分布

非参数 不要求总体分布 品质数据
品质数据往往不是随机变量 由好 很好 差等离散定序数据组成


# 2022-1-8

## PLAN
+ **微生物论文Discussion完成**
+ **单细胞数据检查**
+ **文献阅读**

## 单细胞

### 单细胞数据检查

mouse 数据 /home/ubuntu/data/insilico_pretrubation_data/mouse_epistasis_all.csv

human 数据 /home/ubuntu/data/insilico_pretrubation_data/human_epistasis_all.csv
/home/ubuntu/data/insilico_pretrubation_data/human_epistasis_gene.csv
/home/ubuntu/data/insilico_pretrubation_data/human_epistasis_cell_type.csv

### 模型进度

+ 已修改decoder模型
+ 未添加正则化

## 人类hsc

分化路径 层次


尚在问题 是否可以只调一个转录因子

成熟细胞和祖细胞关系


# 2022-1-9

## PLAN
+ **单细胞可视化**
+ **文献阅读**
+ **微生物论文定稿审查**

## 单细胞可视化

问题 从tfs -> genes 的tsne umap降维效果不好

**double check tf的顺序**

## 微生物论文

### Graphical Abstract
初稿修订完毕


## CellOracle

### Summary
在这里，我们介绍了 CellOracle，这是一种计算工具，它集成了单细胞转录组和表观基因组谱，以推断基因调控网络 (GRN)，这是细胞身份的关键调控因子。利用推断的 GRN，**我们模拟了响应转录因子 (TF) 扰动的基因表达变化**，使网络配置能够在计算机上进行询问，方便他们的解释。**我们验证了 CellOracle 的功效，可以概括造血过程中已知的调节变化，正确预测特征明确的 TF 扰动的结果**。将 CellOracle 分析与直接重编程的谱系追踪相结合，揭示了不同重编程故障模式下的不同网络配置。此外，沿着成功的重编程轨迹分析 GRN 重配置确定了提高靶细胞产量的新因素，揭示了 AP-1 亚基 Fos 与河马信号效应器 Yap1 的作用。总之，这些结果证明了 CellOracle 以高分辨率推断和解释细胞类型特异性 GRN 配置的功效，促进了对细胞身份调节和重编程的新机制见解

### 造血细胞研究

![HSC](https://www.biorxiv.org/content/biorxiv/early/2020/04/21/2020.02.17.947416/F3.large.jpg?width=800&height=600&carousel=1)

# 2022-1-10

## PLAN
+ **微生物论文定稿**

## tmux滚轮

ctrl+B [ 即可正常使用

## LTR 学习内容

+ 3'LTR 5'LTR 末端重复序列 根据这识别
+ 判断失活TE **用进化树聚类分析**

# 2022-1-11

## PLAN
+ 单细胞问题

## 转录因子重建问题

![s](../insilico-purterbation/repots_hsc_human/tfs.png)

蓝色 encoder 后隐藏层
橙色 隐藏层的交互层
绿色 输出层转录因子


# 2022-1-12

## PLAN
+ **LTR 结构研究**
+ **G4 甲基化统计**
+ **LTR初步设计**
+ **微生物文章**

## LTR研究

### 基因破坏和表观遗传控制

**外显子、内含子插入**

**通读转录**

**表观遗传学破坏**

## LTR进化分析

ML树 分析 $K_{ST}$数 进行评估等

详见GBE文献

## LTR 结构
LTR 反转录转座子具有直接的 长末端重复序列，其大小范围从 ~100 bp 到超过 5 kb。反转录转座子LTR是进一步亚分类为Ty1- COPIA样（假病毒科），Ty3-吉普赛样（转座病毒科），和BEL-报样（Belpaoviridae基于两种其序列相似性程度和的顺序）基团编码的基因产物。Ty1- COPIA和Ty3-吉普赛反转录转座子的群体在高拷贝数（最多通常发现每几百万份单倍体 核) 在动物、真菌、原生生物和植物基因组中。迄今为止，仅在动物中发现了类似 BEL-Pao 的元素。

所有功能性 LTR 逆转录转座子至少编码两个基因，gag和pol，它们足以进行复制。Gag编码具有衣壳和核衣壳结构域的多蛋白。Gag 蛋白在细胞质中形成病毒样颗粒，在其中发生逆转录。的波尔基因产生三种蛋白：一个蛋白酶（PR），一个逆转录酶赋予一个RT（逆转录酶）和RNA酶H结构域，和一个整合（IN）。

通常，LTR 逆转录转座子 mRNA 是由宿主RNA pol II作用于位于其 5' LTR 中的启动子产生的。Gag 和 Pol 基因编码在相同的 mRNA 中。根据宿主物种的不同，可以使用两种不同的策略来表达这两种多蛋白：融合成一个开放阅读框 (ORF)，然后将其切割或在两个 ORF 之间引入移码。偶尔的核糖体移码允许产生两种蛋白质，同时确保产生更多的 Gag 蛋白以形成病毒样颗粒。

逆转录通常起始于紧邻 5'-LTR 下游的短序列，称为引物结合位点(PBS)。特定的宿主tRNA与 PBS 结合并充当逆转录的引物，逆转录发生在一个复杂的多步骤过程中，最终产生双链cDNA分子。cDNA 最终被整合到一个新位置，创建了短的 TSD（目标位点重复），并在宿主基因组中添加了一个新副本

# 2022-1-13

## PLAN
+ **微生物文章定稿**
+ **文献阅读**
+ **进化树复习**
+ **统计学学习**

## 统计学学习

### 单因素配对方差检验

组间/组内

组内需要细分需要消除个体间差异 例子 组内差异营销出病人本身指标的因素，可能某些组内差异是由于病人在用药前的指标就有差异

**自由度确定**

组间 总数据（组数个组平均即组数）-平均数（总平均1）

组内 总数据（总数据数）-平均数个数（组数）

### 双因素方差检验

**数据类型**
水平1 水平A 样本
水平1 水平B 样本
水平2 水平A 样本
水平2 水平B 样本

组内变异计算正常计算

组间变异 需要计算A因素 B因素分别算+交互因素

再分别做检验

**自由度**

A/B 因素方差自由度计算 因素均值-总均值 自由度=因素数-平均值数(总均值)
交互效应 A水平数*B水平数-1-A因素自由度-B因素自由度

## 微生物文章定稿

+ 还差discussion 最后一个部分
+ 图的图注
+ 文章中图标记
+ abstract

## GBE文章

### 重点
+	进化树可视化分型
+	利用多指标判断是否失话

### 推荐阅读文章


+ NAR Quadruplex-forming sequences occupy discrete regions inside plant LTR retrotransposons

+ NAR Whole genome experimental maps of DNA G-quadruplexes in multiple species

+ Nature structural & molecular biology https://doi.org/10.1038/ s41594-018-0131-8.

+ Cell http://dx.doi.org/10.1016/j.cell.2016.06.044

+ scientific report https://doi.org/10.1038/s41598-017-14017-4

+ gene http://dx.doi.org/10.1016/j.gene.2017.04.051

+ gbe Evolutionary Dynamics of Retrotransposons Assessed by High-Throughput Sequencing in Wild Relatives of Wheat

## 进化树复习

### 非概率论方法

邻接法（为解决分子钟速率不一致问题） umpga

简约法 用最少碱基替换数目解释 包括确定罚值以及搜索全局最小值


# 2022-1-14

## PLAN
+ **图注**
+ **摘要**

# 2022-1-15

## PLAN
+ **单细胞结果overview**
+ **预训练学习**
+ **微生物结果整合，检查**
+ **拟南芥项目规划**
+ **文献阅读 (cell oracle)**

## 单细胞结果overview
依然无法解决中间层 tf恢复较差的问题

## pre-training (Transforming Learning)

### tricks

Fine-tuning

+ 更小学习率
+ 较少数据迭代
+ 底层更加通用

### encoder

**未设置正则化项**

```py
from functools import reduce
from pickle import load
import torch
import numpy as np
import torch.nn.functional as F
from torch import  nn, optim
import scanpy as sc
from scipy import sparse
import pandas as pd
import Custom_dataLoader
import VAE_model
from torch.utils.data import DataLoader
from early_stop import EarlyStopping
import wandb

adata = sc.read_h5ad("/home/ubuntu/MLPackageStudy/VAE/in-silico/model_Version_2/hsc_anndata_human.h5ad")
gene_names = list(adata.var['gene_symbol'])
adata.obs['cell_type']=adata.obs_names
f = open('/home/ubuntu/MLPackageStudy/VAE/tf-homo-current-symbol.dat','rb')
tfs = f.read()
tfs = str(tfs,encoding='utf-8')
tfs = tfs.split('\r\n')
tfs_hsc_human = set(gene_names) & set(tfs)
tfs_hsc_human = list(tfs_hsc_human)

wandb.init(project="my-test-project", entity="pry2000")
wandb.config = {
"learning_rate": 1e-5,
"batch_size": 128
}

batch_size = 128
learning_rate = 1e-4
patience = 20
data_z_genes = adata.X
data_z = adata[:,tfs_hsc_human].X
# print(data_z_genes.values)
training_set = Custom_dataLoader.CustomDataset(torch.Tensor(np.array(data_z,dtype=np.float32)),torch.Tensor(np.array(data_z_genes,dtype=np.float32)))
training_dataloader = DataLoader(training_set,batch_size, shuffle=True)

def pre_train_loop_decoder(dataloader, model, loss_fn, optimizer,epoch):
    
    size = len(dataloader.dataset)
    loss_epoch = 0
    for batch, (X, y) in enumerate(dataloader):
        # Compute prediction and loss
        pred, _ = model(X)
        loss = loss_fn(pred, y)
        # Backpropagation
        optimizer.zero_grad()
        loss.backward()
        nn.utils.clip_grad_norm_(model.parameters(), max_norm=20, norm_type=2)
        optimizer.step()
        loss_epoch += loss.item()

    print('epoch: ', epoch, '  loss:', loss_epoch/size)
    wandb.log({"loss": loss_epoch/size})
    # Optional
    wandb.watch(model)
    return loss_epoch



model = VAE_model.Decoder_VAE(data_z_genes.shape[1],z_dim = data_z.shape[1])
optimizer = optim.Adam(model.parameters(), lr=learning_rate)
criterion = nn.MSELoss(reduction = "sum")
print(model)
early_stopping = EarlyStopping(patience=patience, verbose=True,path="/home/ubuntu/MLPackageStudy/VAE/in-silico/model_Version_2/encoder_human_checkpoint.pt")
for epoch in range(100):
    loss = pre_train_loop_decoder (training_dataloader,model,criterion, optimizer,epoch)
    model.eval()
    early_stopping(loss, model)
    if early_stopping.early_stop:
        break
```

### decoder

**代码类似但没有考虑两层TFs**

## 拟南芥项目规划

### Yijia Liu's TASK

+ 熟悉pipeline 1
+ 利用爬虫 (python) 学习如何下载 相关文件
+ 甲基化网站 https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE43857
+ https://www.arabidopsis.org/download/index-auto.jsp?dir=%2Fdownload_files%2FGenes%2FTAIR10_genome_release%2FTAIR10_transposable_elements 转座子库

## cell oracle


### 数据集

Hsc 数据集

### 原理

首先利用已知信息创建基础网络

再对不同类别创建特异性调控网络贝叶斯边际理论

再对特定转录因子波动 网络多次迭代达到稳态


# 2022-1-16

## PLAN
+ **单细胞结果处理**
+ **LTR工具操作**
+ 深度学习文章学习

## BLAST

### 步骤

LTR_Finder识别后，提取每一个LTR，再进行blast，blast后再进行处理


### blast操作

**已完成**
+ 拟南芥转座子库下载
+ blast 建库

blast比对操作

```bash
# -query 后面是带查询的序列 -db是建库的数据库即tedb数据库
blastn -query test.fa -db /home/ubuntu/data/softwares/tedb -outfmt 6
```


**输出**
1. Query id：查询序列ID标识
2. Subject id：比对上的目标序列ID标识
3. % identity：序列比对的一致性百分比
4. alignment length：符合比对的比对区域的长度
5. mismatches：比对区域的错配数
6. gap openings：比对区域的gap数目
7. q. start：比对区域在查询序列(Query id)上的起始位点
8. q. end：比对区域在查询序列(Query id)上的终止位点
9. s. start：比对区域在目标序列(Subject id)上的起始位点
10. s. end：比对区域在目标序列(Subject id)上的终止位点
11. e-value：比对结果的期望值
12. bit score：比对结果的bit score值


```xml
chr1    AT1TE52125|-|15827287|15838845|ATHILA2|LTR/Gypsy|11559  100.000 540     0       0       181     720     1       540     0.0     998
chr1    AT3TE50655|-|12211825|12218034|ATHILA2|LTR/Gypsy|6210   99.074  540     5       0       181     720     875     1414    0.0     970
chr1    AT1TE52110|-|15822576|15826633|ATHILA2|LTR/Gypsy|4058   99.074  540     5       0       181     720     1       540     0.0     970
chr1    AT2TE22520|+|5573729|5578989|ATHILA2|LTR/Gypsy|5261     98.704  540     7       0       181     720     18      557     0.0     959
chr1    AT4TE16565|-|3736029|3742064|ATHILA2|LTR/Gypsy|6036     98.148  540     10      0       181     720     707     1246    0.0     942
chr1    AT5TE42965|-|12029290|12035478|ATHILA2|LTR/Gypsy|6189   97.963  540     11      0       181     720     870     1409    0.0     937
chr1    AT1TE49850|+|15186993|15192976|ATHILA2|LTR/Gypsy|5984   97.963  540     11      0       181     720     706     1245    0.0     937
chr1    AT5TE42355|+|11777537|11782793|ATHILA2|LTR/Gypsy|5253   98.131  535     10      0       181     715     61      595     0.0     933
chr1    AT3TE62025|+|15257913|15263797|ATHILA2|LTR/Gypsy|5885   97.407  540     14      0       181     720     543     1082    0.0     920
chr1    AT2TE16230|-|3750178|3766283|ATHILA2|LTR/Gypsy|5438     96.811  533     17      0       188     720     1       533     0.0     891
chr1    AT4TE19150|+|4555124|4560555|ATHILA2|LTR/Gypsy|5432     96.111  540     21      0       181     720     19      558     0.0     881
chr1    AT3TE57150|+|13909790|13915698|ATHILA6A|LTR/Gypsy|5909  95.185  540     26      0       181     720     469     1008    0.0     854
chr1    AT4TE16400|+|3697525|3703860|ATHILA2|LTR/Gypsy|6336     94.630  540     29      0       181     720     1035    1574    0.0     837
chr1    AT3TE55340|+|13603229|13609413|ATHILA2|LTR/Gypsy|6185   94.630  540     28      1       181     720     874     1412    0.0     835
chr1    AT1TE51065|+|15500423|15504894|ATHILA2|LTR/Gypsy|4473   94.259  540     31      0       181     720     61      600     0.0     826
chr1    AT1TE46575|-|14178069|14183542|ATHILA2|LTR/Gypsy|5454   93.889  540     33      0       181     720     222     761     0.0     815
chr1    AT5TE43815|-|12338677|12342939|ATHILA2|LTR/Gypsy|4263   93.704  540     23      1       181     720     706     1234    0.0     798
```

进一步处理

LTR处理路径即
+ LTR_Finder 输出文件 **.ltr
+ **.ltr-> **.ltr.bed
+ **.ltr.bed/ **.fasta -> **.ltr.fasta
+ blast **.ltr.fasta-> **.ltr.xml
+ 最终进行判断


# 2022-1-17

## PLAN

+ **单细胞源代码学习**
+ **ltr pipeline**
+ **统计学学习**

## 单细胞源代码学习
修改网络架构
进行预训练 encoder层面
要想在内存有限的情况下训练，需要减小batchsize

## ltr

### ML树

两个potential choices

+ raxml
+ iqtree

msa -> tree

## 多重检验

当通过方差检验发现多组之间存在差异时，如果逐个进行t检验，错误概率会大大增加

$$r_{error} = 1-(1-\alpha)^n$$

所以要进行修正，包括对于每个检验的$\alpha$值进行修正，对于检验统计量的矫正以及分布的矫正

### Bonferroni 法

本质对于$\alpha$值进行矫正

$$\alpha'=\alpha/n$$

当样本大于5时过于严格

### Scheff 法

$$\sum c_j\mu_j,s.t. \sum c_j=0$$

重新抽早统计量进行对比，计算是否具有显著性与$F(j-1,N-j;\alpha)$进行比较

$j$组数，$N$样本数


### Tukey 法

更改统计量

# 2022-1-18

## PLAN
+ **单细胞pre-train**
+ **bcftools探究**

## 序列下载

+ 下载vcf文件
+ 利用**bcftools** 和参考基因组 构建新序列
```bash
 bcftools consensus -I -f /home/ubuntu/Arabidopsis/Arabidopsis_sequence/Col-0/Col-0.fasta in.new.vcf.gz > out.fa
 ```


# 2022-1-20

## PLAN
+ **TE/G4构架设计**
+ **单细胞预训练**
+ **毕业设计相关文件**

## 单细胞预训练

修改网络架构，只训练均值后，出现了较好的结果

## TE/G4构架设计

### VCF files

link https://blog.csdn.net/u012150360/article/details/70666213

## 下载格式

e.g.

data
------ 2212
------------ 2212对应的甲基化文件
------------ fasta

下载函数

一个参数 2212

# 2022-1-21

## PLAN
+ **统计学学习**
+ **单细胞架构训练**
+ **文献阅读**

## 统计学习

数据不平衡TK法

### Tukey法 & TK法

统计量
$$t_{\bar{x_1}-\bar{x_2}}=\frac{\bar{x_1}-\bar{x_2}}{\sqrt{\frac{\^{\sigma_e}}{n}}}$$

$$t_{\bar{x_1}-\bar{x_2}}=\frac{\bar{x_1}-\bar{x_2}}{\sqrt{{\sigma_e}*(1/n_1+1/n_2)}}$$

$\^{\sigma_e}$为总体样本的无偏估计方差（所有组共同的无偏方差）

临界值

$$q=\frac{\bar{x_{max}}-\bar{x_{min}}}{\sqrt{\frac{\^{\sigma_e}}{n}}}$$

$$q=\frac{\bar{x_{max}}-\bar{x_{min}}}{\sqrt{{\sigma_e}*(1/n_1+1/n_2)}}$$

$q$服从**学生化极差分布**

查表计算q值是否有显著性，q值由组数和自由度决定

**学生化极差分布** 意义 一组数据中平均数最大和平均数最小的组统计检验值的**检验统计量**$q$最大即他们的分布是最严格的，当任意两组中的检验统计量在置信区间外，就可以判断显著性，这也规避了多重性问题

### 与两两t分布区别

更加严格，因为检验统计量的数学意义是自由度为$v$组数为$s$的数据中，统计量差异最大的两组的差异统计量分布作为检验统计量，而独立$t$检验没有规避多重性问题。

## 单细胞架构训练

loss 缩小了，但可能模型复杂度不够 内存崩溃问题

# 2022-1-22

## PLAN
+ **统计学学习**
+ **单细胞架构训练**
+ **文献阅读**
+ **深度学习**
+ **pipeline 代码检查**

## 代码检查

file downloadfile.py
package 7323 报错 原因 没有相应的key

## BERT 微调

### Sentence Level
用 `<cls>`的embedding 进行二分类或者多分类

### word level
对非特殊词的embedding 进行分类任务

### QA
给定一个问题和一段文字，找到一个片段进行回答


## 非参数检验

处理品质数据(描述数据,定序数据)或由于极值导致非正态or $t分布$的统计量

### 皮尔逊卡方检验

利用期望频数和实际频数做比较

# 2022-1-23

## PLAN
+ **统计学学习**
+ **单细胞training**

## 统计学学习

### 皮尔逊卡方

多样本 制造卡方统计量 用观测数据代替$x$用期望数据代替方差和均值

### 2x2 联表

Fisher 确切检验 通过固定边际频数

将当前频数和更极端的概率相加和统计检验量作比较


# 2022-1-24

## PLAN
+ **vi学习**
+ **单细胞training**
+ **统计学学习**

## vi学习

替代mcmc采样计算均值方差

通过先验和似然概率估计后验概率
输出依然为均值方差 很可能无法输出角解析解


问题  还不了解使用场景


## 统计学学习

### U检验

原始数据 -> 排序定序数据 -> U值

U值 小样本通过查表 大样本计算$z_U=\frac{U-\mu_U}{\sigma_U}$

若原始数据为大样本 需要做修正

# 2022-1-26

## PLAN
+ **UW 申请填报**
+ **统计学学习**
+ NTU论文overview
+ 拟南芥项目文献阅读
+ **单细胞可视化**


## 单细胞可视化

from X to Z 重建效果很差

## 参数非参数检验比较

不同的方法至要观注样本值类型，样本数 样本分布是否配对以及样本中重复数等 非参数平均数易利用秩和的修正分布查表 或大样本z检验

![Image](非参数检验.png)
